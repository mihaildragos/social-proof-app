const { Kafka } = require("kafkajs"); const kafka = new Kafka({ clientId: "test", brokers: ["kafka:9092"] }); const producer = kafka.producer(); producer.connect().then(() => { console.log("Connected"); return producer.send({ topic: "events.orders", messages: [{ key: "83bbcff3-1932-41a6-9e1a-08b93374dd64-123456", value: JSON.stringify({ type: "order.created", siteId: "83bbcff3-1932-41a6-9e1a-08b93374dd64", data: { id: 123456, name: "#TEST123", customer: { first_name: "John" }, line_items: [{ title: "Test Product" }] }, timestamp: new Date().toISOString() }) }] }); }).then(() => { console.log("Message sent"); return producer.disconnect(); }).catch(console.error);
